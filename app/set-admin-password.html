<!DOCTYPE html>
<html>
<head>
    <title>Set Admin Password</title>
    <script type="module">
        import { createClient } from './node_modules/@supabase/supabase-js/dist/module/index.js';
        
        const supabaseUrl = 'https://shejpknspmrlgbjhhptx.supabase.co';
        const serviceRoleKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNoZWpwa25zcG1ybGdiamhocHR4Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2NjkzMDU0OSwiZXhwIjoyMDgyNTA2NTQ5fQ.1A4yV38E8lEjlgJnr1g3txHhgNGPmTlSOLkUB_ZrX8A';
        
        const adminClient = createClient(supabaseUrl, serviceRoleKey, {
            auth: { autoRefreshToken: false, persistSession: false }
        });
        
        async function setPassword() {
            const status = document.getElementById('status');
            status.innerHTML = 'üîê Setting password...';
            
            try {
                const { data: users } = await adminClient.auth.admin.listUsers();
                const adminUser = users.users.find(u => u.email?.toLowerCase() === 'admin@ubs.com');
                
                if (!adminUser) {
                    const { data: newUser, error: e } = await adminClient.auth.admin.createUser({
                        email: 'admin@ubs.com',
                        password: 'adminubs@1234',
                        email_confirm: true
                    });
                    if (e) throw e;
                    status.innerHTML = '‚úÖ Created auth user! Password: adminubs@1234';
                } else {
                    const { data: updated, error: e } = await adminClient.auth.admin.updateUserById(
                        adminUser.id, 
                        { password: 'adminubs@1234', email_confirm: true }
                    );
                    if (e) throw e;
                    status.innerHTML = '‚úÖ Password updated! Login with: admin@ubs.com / adminubs@1234';
                }
            } catch (err) {
                status.innerHTML = '‚ùå Error: ' + err.message;
            }
        }
        
        window.setPassword = setPassword;
        setPassword();
    </script>
</head>
<body>
    <h1>Set Admin Password</h1>
    <div id="status">Loading...</div>
</body>
</html>
